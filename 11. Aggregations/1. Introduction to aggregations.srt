1
00:00:02,450 --> 00:00:06,690
このセクションでは､ 集約と呼ばれるものを見ていきます｡ 

2
00:00:06,710 --> 00:00:14,030
リレーショナルデータベースでこのようなことはご存知かもしれませんが､ Elasticsearchのアグリゲーションはそれよりもずっと強力です｡

3
00:00:14,630 --> 00:00:25,970
つまり､ 集約はデータをグループ化して統計やサマリーを抽出する方法であり､ 集約は実行コンテキストによって定義されるドキュメントのセットに対して機能します｡

4
00:00:26,360 --> 00:00:32,390
というと､ 派手な感じがしますが､ これからの講義でわかると思いますので､ 今は気にしないでください｡

5
00:00:32,930 --> 00:00:39,770
各文書が注文に対応し､ 各注文が金額と商品を含むインデックスがあるとする｡

6
00:00:39,770 --> 00:00:50,060
ID 集約の簡単な例としては､ 注文を商品IDでより密にグループ化し､ 各商品がいくらで売れたかを金額で表示することができます｡

7
00:00:50,480 --> 00:00:57,980
同様に､ 製品ごとに平均受注金額を算出し､ どの製品が受注1件あたりの売上が多いかを確認することができます｡

8
00:00:58,430 --> 00:01:04,160
このセクションで紹介するアグリゲーションでは､ それよりもはるかに複雑なことを行うことができます｡

9
00:01:04,640 --> 00:01:11,240
このセクションでは､ 集約を扱うのにふさわしい新しいテストデータを使用します｡

10
00:01:11,300 --> 00:01:15,980
具体的には､ orderというインデックスの中で､ いくつものオーダーが始まる｡ 

11
00:01:16,400 --> 00:01:20,900
このテストデータは､ この講義に添付されているものか､ GitHubのリポジトリ内で見ることができます｡ 

12
00:01:21,320 --> 00:01:25,940
また､ GitHubのリポジトリに､ テストデータをインポートする前に追加しておくべきマッピングを追加しましたので､

13
00:01:25,940 --> 00:01:27,680
必ず確認してください｡

14
00:01:28,280 --> 00:01:33,410
このデータはあらかじめインポートしてあるので､ これから始まる講義でどのフィールドが自由に使えるか､

15
00:01:33,410 --> 00:01:36,920
マッピングを見ながら説明しましょう｡

16
00:01:37,340 --> 00:01:43,820
マッピングを見るためのクエリは､ もう何度か見たことがあると思いますので､ そのまま実行してみましょう｡

17
00:01:45,520 --> 00:01:50,710
そこで､ ランスフィールドを用意しました｡ ランスフィールドは､ 互いに区別できるようにする必要があるオブジェクトを含んでいるので､

18
00:01:50,710 --> 00:01:52,690
入れ子タイプになっています｡

19
00:01:53,170 --> 00:01:56,650
それは､ テストデータには配列内のオブジェクトが含まれているからです｡ 

20
00:01:57,130 --> 00:02:01,330
各注文行には､ 金額､ 商品､ ID､ 数量が含まれる｡ 

21
00:02:01,600 --> 00:02:07,330
また､ 注文時のタイムスタンプも購入アンダースコア追加フィールドに格納されています｡

22
00:02:07,780 --> 00:02:12,880
次に､ 注文の発信元を保存するためのフィールドを用意します｡  e. 販売チャネル

23
00:02:13,240 --> 00:02:19,660
各注文には､ 販売を行った人のIDと名前の両方からなるセールスマン・オブジェクトがあります｡ 

24
00:02:20,420 --> 00:02:29,660
最後に､ ステータス・フィールドと､ Total Underscore Amountという便利なフィールドがありますが､ これはオーダー・ライン内に格納されているすべての金額を合計したものです｡

25
00:02:29,960 --> 00:02:32,960
これらは､ 今後の講義で使用するフィールドです｡ 

26
00:02:33,410 --> 00:02:41,060
さて､ アグリゲーションには様々なグループがありますが､ まずはメトリックアグリゲーションと呼ばれるものから個別に見ていきましょう｡

27
00:02:41,090 --> 00:02:42,830
では､ さっそく始めましょう｡ 
