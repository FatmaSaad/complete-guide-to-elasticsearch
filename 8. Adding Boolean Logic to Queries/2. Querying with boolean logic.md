# Querying with boolean logic

Time to write a few more advanced queries by using the pool query.

This query is used for adding Boolean logic to a query.

You can think of this query as being similar to the weight loss in SQL, although the pool query is more advanced because it also deals with relevant scores.

Before diving into it, I first want to recap on something I covered earlier in the course the contexts in which a query can be run.

You might recall that a query can either be run in a query context or in a filter context.

The difference is essential for understanding the pull query within a query.

Context.

Relevance.

Scores are calculated and documents are ordered.

But how will the magic given query in a filter context is only determined whether or not a document matches a query and not how well it matches a query.

The pool query can be used within both contexts, but we're going to use the query context for now.

With that fresh in our memory.

Let's get to work with the pool query.


## Adding query clauses to the `must` key

```
GET /recipe/_search
{
  "query": {
    "bool": {
      "must": [
        {
          "match": {
            "ingredients.name": "parmesan"
          }
        },
        {
          "range": {
            "preparation_time_minutes": {
              "lte": 15
            }
          }
        }
      ]
    }
  }
}
```

So let me just enter the pool query type first and an empty objects.

What I want to do first is to match recipes that contain Parmesan as an ingredient.

And because I'm feeling lazy, I want the preparation time to be 15 minutes or less.

I can do that by specifying queries within a key named must.

So let's add the must key and that's an array as you can see.

So this array will contain an array of objects and each object will be a query class.

So let's add the first objects which will be a match query query the ingredients start name fields for the term parmesan.

So that was one of the constraints.

Let's add another query clause within the must array being arranged query for the preparation time minutes field and I will specify the lce key and 15 as the value.

So as you can see here, I'm just specifying query clauses within the mastery.

So the objects that you add within this array are exactly the same as the queries that you've seen before.

Note that I added an array as the value for the Ms. key.

You can also add an object with the crews as keys, but that only works if you don't have more than one query of the same type.

I just prefer to specify an array.

So that's the syntax that I have chosen.

Okay, so what does this actually mean?

It probably comes as no surprise to you that the queries within the must key must be satisfied for document to match the query queries nested within the mosque must match.

But it's also important to note that the queries will contribute to a document's relevance score.

This means that while the document must be matched by all queries within the must, objects or must array, it's also scored by how well it matches those queries.

This happens based on various relevant scores that we discussed earlier.

With that being said, let's just run the query so you can see the results.

```
{
  "took" : 5,
  "timed_out" : false,
  "_shards" : {
    "total" : 1,
    "successful" : 1,
    "skipped" : 0,
    "failed" : 0
  },
  "hits" : {
    "total" : {
      "value" : 3,
      "relation" : "eq"
    },
    "max_score" : 2.3795729,
    "hits" : [
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "1",
        "_score" : 2.3795729,
        "_ignored" : [
          "description.keyword",
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Fast and Easy Pasta With Blistered Cherry Tomato Sauce",
          "description" : "Cherry tomatoes are almost always sweeter, riper, and higher in pectin than larger tomatoes at the supermarket. All of these factors mean that cherry tomatoes are fantastic for making a rich, thick, flavorful sauce. Even better: It takes only four ingredients and about 10 minutes, start to finish—less time than it takes to cook the pasta you're gonna serve it with.",
          "preparation_time_minutes" : 12,
          "servings" : {
            "min" : 4,
            "max" : 6
          },
          "steps" : [
            "Place pasta in a large skillet or sauté pan and cover with water and a big pinch of salt. Bring to a boil over high heat, stirring occasionally. Boil until just shy of al dente, about 1 minute less than the package instructions recommend.",
            "Meanwhile, heat garlic and 4 tablespoons (60ml) olive oil in a 12-inch skillet over medium heat, stirring frequently, until garlic is softened but not browned, about 3 minutes. Add tomatoes and cook, stirring, until tomatoes begin to burst. You can help them along by pressing on them with the back of a wooden spoon as they soften.",
            "Continue to cook until sauce is rich and creamy, about 5 minutes longer. Stir in basil and season to taste with salt and pepper.",
            "When pasta is cooked, drain, reserving 1 cup of pasta water. Add pasta to sauce and increase heat to medium-high. Cook, stirring and tossing constantly and adding reserved pasta water as necessary to adjust consistency to a nice, creamy flow. Remove from heat, stir in remaining 2 tablespoons (30ml) olive oil, and grate in a generous shower of Parmesan cheese. Serve immediately, passing extra Parmesan at the table."
          ],
          "ingredients" : [
            {
              "name" : "Dry pasta",
              "quantity" : "450g"
            },
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Cloves garlic",
              "quantity" : "4"
            },
            {
              "name" : "Extra-virgin olive oil",
              "quantity" : "90ml"
            },
            {
              "name" : "Cherry tomatoes",
              "quantity" : "750g"
            },
            {
              "name" : "Fresh basil leaves",
              "quantity" : "30g"
            },
            {
              "name" : "Freshly ground black pepper"
            },
            {
              "name" : "Parmesan cheese"
            }
          ],
          "created" : "2017/03/29",
          "ratings" : [
            4.5,
            5.0,
            3.0,
            4.5
          ]
        }
      },
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "10",
        "_score" : 2.2786832,
        "_ignored" : [
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Penne With Hot-As-You-Dare Arrabbiata Sauce",
          "description" : """Exceedingly simple in concept and execution, arrabbiata sauce is tomato sauce with the distinction of being spicy enough to earn its "angry" moniker. Here's how to make it, from start to finish.""",
          "preparation_time_minutes" : 15,
          "servings" : {
            "min" : 4,
            "max" : 4
          },
          "steps" : [
            "In a medium saucepan of boiling salted water, cook penne until just short of al dente, about 1 minute less than the package recommends.",
            "Meanwhile, in a large skillet, combine oil, garlic, and pepper flakes. Cook over medium heat until garlic is very lightly golden, about 5 minutes. (Adjust heat as necessary to keep it gently sizzling.)",
            "Add tomatoes, stir to combine, and bring to a bare simmer. When pasta is ready, transfer it to sauce using a strainer or slotted spoon. (Alternatively, drain pasta through a colander, reserving 1 cup of cooking water. Add drained pasta to sauce.)",
            "Add about 1/4 cup pasta water to sauce and increase heat to bring pasta and sauce to a vigorous simmer. Cook, stirring and shaking the pan and adding more pasta water as necessary to keep sauce loose, until pasta is perfectly al dente, 1 to 2 minutes longer. (The pasta will cook more slowly in the sauce than it did in the water.)",
            "Continue cooking pasta until sauce thickens and begins to coat noodles, then remove from heat and toss in cheese and parsley, stirring vigorously to incorporate. Stir in a drizzle of fresh olive oil, if desired. Season with salt and serve right away, passing more cheese at the table."
          ],
          "ingredients" : [
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Penne pasta",
              "quantity" : "450g"
            },
            {
              "name" : "Extra-virgin olive oil",
              "quantity" : "3 tablespoons"
            },
            {
              "name" : "Clove garlic",
              "quantity" : "1"
            },
            {
              "name" : "Crushed red pepper"
            },
            {
              "name" : "Can whole peeled tomatoes",
              "quantity" : "400g"
            },
            {
              "name" : "Finely grated Parmesan cheese",
              "quantity" : "60g"
            },
            {
              "name" : "Minced flat-leaf parsley leaves",
              "quantity" : "Small handful"
            }
          ],
          "created" : "2017/04/27",
          "ratings" : [
            1.5,
            2.0,
            4.0,
            3.5,
            3.0,
            5.0,
            1.5
          ]
        }
      },
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "11",
        "_score" : 2.0361936,
        "_ignored" : [
          "description.keyword",
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Spaghetti Puttanesca (Pasta or Spaghetti With Capers, Olives, and Anchovies)",
          "description" : "\"Puttanesca\" literally translates to \"in the style of prostitutes,\" supposedly because the pungent aromas of garlic, anchovies, capers, and olives tossed with pasta were how Neapolitan prostitutes would lead customers to their doors. This is one of those stories that seem, in the words of Douglas Adams, apocryphal or at least wildly inaccurate. That said, it's a fitting title—puttanesca packs an aromatic punch and then some.",
          "preparation_time_minutes" : 15,
          "servings" : {
            "min" : 2,
            "max" : 3
          },
          "steps" : [
            "Place spaghetti in a large skillet, sauté pan, or saucepan and cover with water. Add a small pinch of salt. Bring to a boil over high heat, stirring occasionally to prevent pasta from sticking.",
            "Meanwhile, in a medium skillet, combine 4 tablespoons (60ml) oil, garlic, anchovies, and red pepper flakes. Cook over medium heat until garlic is very lightly golden, about 5 minutes. (Adjust heat as necessary to keep it gently sizzling.) Add capers and olives and stir to combine.",
            "Add tomatoes, stir to combine, and bring to a bare simmer. Continue to simmer until pasta is cooked to just under al dente (about 1 minute less than the package recommends).",
            "Using tongs, transfer pasta to sauce. Alternatively, drain pasta through a colander, reserving 1 cup of the cooking water. Add drained pasta to sauce.",
            "Add a few tablespoons of pasta water to sauce and increase heat to bring pasta and sauce to a vigorous simmer. Cook, stirring and shaking the pan and adding more pasta water as necessary to keep sauce loose, until pasta is perfectly al dente, 1 to 2 minutes longer. (The pasta will cook more slowly in the sauce than it did in the water.) Stir in remaining olive oil, parsley, and cheese.",
            "Season with salt and pepper. (Be generous with the pepper and scant with the salt—the dish will be plenty salty from the other ingredients.) If using, stir in canned tuna and break it up with a fork. Serve immediately with more grated cheese at the table."
          ],
          "ingredients" : [
            {
              "name" : "Dried spaghetti",
              "quantity" : "225g"
            },
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Extra-virgin olive oil",
              "quantity" : "6 tablespoons"
            },
            {
              "name" : "Cloves garlic",
              "quantity" : "4"
            },
            {
              "name" : "Anchovy fillets",
              "quantity" : "4-6"
            },
            {
              "name" : "Large pinch red pepper flakes"
            },
            {
              "name" : "Capers",
              "quantity" : "1/4 cup"
            },
            {
              "name" : "Pitted black olives",
              "quantity" : "1/4 cup"
            },
            {
              "name" : "Whole peeled tomatoes",
              "quantity" : "225g"
            },
            {
              "name" : "Minced fresh parsley leaves",
              "quantity" : "Small handful"
            },
            {
              "name" : "Finely grated Pecorino Romano or Parmesan cheese",
              "quantity" : "30g"
            },
            {
              "name" : "Freshly ground black pepper"
            },
            {
              "name" : "Can oil-packed tuna",
              "quantity" : "140g"
            }
          ],
          "created" : "2011/02/21",
          "ratings" : [
            0.5,
            1.0,
            0.5,
            1.5,
            2.0
          ]
        }
      }
    ]
  }
}
```
And we should find that the recipes do indeed contain Parmesan and have a preparation time of less than or equal to 15.

Okay.

So we can actually improve our query because it makes no sense to try to calculate how well a document satisfied the range query.

It's really a yes or no question.

Instead of keeping the query within the mastery, we should move it within a filter object.

While Elasticsearch is smart enough to just apply a constant score of one to the range query when it's placed within the mastery, the filter object has an edge in terms of performance.

The filter object is for queries that either match or they don't, i.e.

there's no such thing as how well they match.

More precisely, queries within this object are run in a filter context as opposed to the query context, which is why scoring is ignored.

Caching is where filter crews have an edge because the query clauses can be cached for subsequent queries.

This is because the result of the query clauses directly depends on the query and the documents.

There's no notion of how well the documents match, so this makes the results much easier to cache.

Enough talking.

Let's move the query to the filter objects.

## Moving the `range` query to the `filter` key

```
GET /recipe/_search
{
  "query": {
    "bool": {
      "must": [
        {
          "match": {
            "ingredients.name": "parmesan"
          }
        }
      ],
      "filter": [
        {
          "range": {
            "preparation_time_minutes": {
              "lte": 15
            }
          }
        }
      ]
    }
  }
}
```
So I'll go ahead and cut this object right here and add a filter object.

Or actually I'll add it as an array, but the same rules apply as with the must key, and I'll just paste it in here running the query.

We should get the exact same matches as before.
```
{
  "took" : 1,
  "timed_out" : false,
  "_shards" : {
    "total" : 1,
    "successful" : 1,
    "skipped" : 0,
    "failed" : 0
  },
  "hits" : {
    "total" : {
      "value" : 3,
      "relation" : "eq"
    },
    "max_score" : 1.379573,
    "hits" : [
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "1",
        "_score" : 1.379573,
        "_ignored" : [
          "description.keyword",
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Fast and Easy Pasta With Blistered Cherry Tomato Sauce",
          "description" : "Cherry tomatoes are almost always sweeter, riper, and higher in pectin than larger tomatoes at the supermarket. All of these factors mean that cherry tomatoes are fantastic for making a rich, thick, flavorful sauce. Even better: It takes only four ingredients and about 10 minutes, start to finish—less time than it takes to cook the pasta you're gonna serve it with.",
          "preparation_time_minutes" : 12,
          "servings" : {
            "min" : 4,
            "max" : 6
          },
          "steps" : [
            "Place pasta in a large skillet or sauté pan and cover with water and a big pinch of salt. Bring to a boil over high heat, stirring occasionally. Boil until just shy of al dente, about 1 minute less than the package instructions recommend.",
            "Meanwhile, heat garlic and 4 tablespoons (60ml) olive oil in a 12-inch skillet over medium heat, stirring frequently, until garlic is softened but not browned, about 3 minutes. Add tomatoes and cook, stirring, until tomatoes begin to burst. You can help them along by pressing on them with the back of a wooden spoon as they soften.",
            "Continue to cook until sauce is rich and creamy, about 5 minutes longer. Stir in basil and season to taste with salt and pepper.",
            "When pasta is cooked, drain, reserving 1 cup of pasta water. Add pasta to sauce and increase heat to medium-high. Cook, stirring and tossing constantly and adding reserved pasta water as necessary to adjust consistency to a nice, creamy flow. Remove from heat, stir in remaining 2 tablespoons (30ml) olive oil, and grate in a generous shower of Parmesan cheese. Serve immediately, passing extra Parmesan at the table."
          ],
          "ingredients" : [
            {
              "name" : "Dry pasta",
              "quantity" : "450g"
            },
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Cloves garlic",
              "quantity" : "4"
            },
            {
              "name" : "Extra-virgin olive oil",
              "quantity" : "90ml"
            },
            {
              "name" : "Cherry tomatoes",
              "quantity" : "750g"
            },
            {
              "name" : "Fresh basil leaves",
              "quantity" : "30g"
            },
            {
              "name" : "Freshly ground black pepper"
            },
            {
              "name" : "Parmesan cheese"
            }
          ],
          "created" : "2017/03/29",
          "ratings" : [
            4.5,
            5.0,
            3.0,
            4.5
          ]
        }
      },
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "10",
        "_score" : 1.2786832,
        "_ignored" : [
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Penne With Hot-As-You-Dare Arrabbiata Sauce",
          "description" : """Exceedingly simple in concept and execution, arrabbiata sauce is tomato sauce with the distinction of being spicy enough to earn its "angry" moniker. Here's how to make it, from start to finish.""",
          "preparation_time_minutes" : 15,
          "servings" : {
            "min" : 4,
            "max" : 4
          },
          "steps" : [
            "In a medium saucepan of boiling salted water, cook penne until just short of al dente, about 1 minute less than the package recommends.",
            "Meanwhile, in a large skillet, combine oil, garlic, and pepper flakes. Cook over medium heat until garlic is very lightly golden, about 5 minutes. (Adjust heat as necessary to keep it gently sizzling.)",
            "Add tomatoes, stir to combine, and bring to a bare simmer. When pasta is ready, transfer it to sauce using a strainer or slotted spoon. (Alternatively, drain pasta through a colander, reserving 1 cup of cooking water. Add drained pasta to sauce.)",
            "Add about 1/4 cup pasta water to sauce and increase heat to bring pasta and sauce to a vigorous simmer. Cook, stirring and shaking the pan and adding more pasta water as necessary to keep sauce loose, until pasta is perfectly al dente, 1 to 2 minutes longer. (The pasta will cook more slowly in the sauce than it did in the water.)",
            "Continue cooking pasta until sauce thickens and begins to coat noodles, then remove from heat and toss in cheese and parsley, stirring vigorously to incorporate. Stir in a drizzle of fresh olive oil, if desired. Season with salt and serve right away, passing more cheese at the table."
          ],
          "ingredients" : [
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Penne pasta",
              "quantity" : "450g"
            },
            {
              "name" : "Extra-virgin olive oil",
              "quantity" : "3 tablespoons"
            },
            {
              "name" : "Clove garlic",
              "quantity" : "1"
            },
            {
              "name" : "Crushed red pepper"
            },
            {
              "name" : "Can whole peeled tomatoes",
              "quantity" : "400g"
            },
            {
              "name" : "Finely grated Parmesan cheese",
              "quantity" : "60g"
            },
            {
              "name" : "Minced flat-leaf parsley leaves",
              "quantity" : "Small handful"
            }
          ],
          "created" : "2017/04/27",
          "ratings" : [
            1.5,
            2.0,
            4.0,
            3.5,
            3.0,
            5.0,
            1.5
          ]
        }
      },
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "11",
        "_score" : 1.0361936,
        "_ignored" : [
          "description.keyword",
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Spaghetti Puttanesca (Pasta or Spaghetti With Capers, Olives, and Anchovies)",
          "description" : "\"Puttanesca\" literally translates to \"in the style of prostitutes,\" supposedly because the pungent aromas of garlic, anchovies, capers, and olives tossed with pasta were how Neapolitan prostitutes would lead customers to their doors. This is one of those stories that seem, in the words of Douglas Adams, apocryphal or at least wildly inaccurate. That said, it's a fitting title—puttanesca packs an aromatic punch and then some.",
          "preparation_time_minutes" : 15,
          "servings" : {
            "min" : 2,
            "max" : 3
          },
          "steps" : [
            "Place spaghetti in a large skillet, sauté pan, or saucepan and cover with water. Add a small pinch of salt. Bring to a boil over high heat, stirring occasionally to prevent pasta from sticking.",
            "Meanwhile, in a medium skillet, combine 4 tablespoons (60ml) oil, garlic, anchovies, and red pepper flakes. Cook over medium heat until garlic is very lightly golden, about 5 minutes. (Adjust heat as necessary to keep it gently sizzling.) Add capers and olives and stir to combine.",
            "Add tomatoes, stir to combine, and bring to a bare simmer. Continue to simmer until pasta is cooked to just under al dente (about 1 minute less than the package recommends).",
            "Using tongs, transfer pasta to sauce. Alternatively, drain pasta through a colander, reserving 1 cup of the cooking water. Add drained pasta to sauce.",
            "Add a few tablespoons of pasta water to sauce and increase heat to bring pasta and sauce to a vigorous simmer. Cook, stirring and shaking the pan and adding more pasta water as necessary to keep sauce loose, until pasta is perfectly al dente, 1 to 2 minutes longer. (The pasta will cook more slowly in the sauce than it did in the water.) Stir in remaining olive oil, parsley, and cheese.",
            "Season with salt and pepper. (Be generous with the pepper and scant with the salt—the dish will be plenty salty from the other ingredients.) If using, stir in canned tuna and break it up with a fork. Serve immediately with more grated cheese at the table."
          ],
          "ingredients" : [
            {
              "name" : "Dried spaghetti",
              "quantity" : "225g"
            },
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Extra-virgin olive oil",
              "quantity" : "6 tablespoons"
            },
            {
              "name" : "Cloves garlic",
              "quantity" : "4"
            },
            {
              "name" : "Anchovy fillets",
              "quantity" : "4-6"
            },
            {
              "name" : "Large pinch red pepper flakes"
            },
            {
              "name" : "Capers",
              "quantity" : "1/4 cup"
            },
            {
              "name" : "Pitted black olives",
              "quantity" : "1/4 cup"
            },
            {
              "name" : "Whole peeled tomatoes",
              "quantity" : "225g"
            },
            {
              "name" : "Minced fresh parsley leaves",
              "quantity" : "Small handful"
            },
            {
              "name" : "Finely grated Pecorino Romano or Parmesan cheese",
              "quantity" : "30g"
            },
            {
              "name" : "Freshly ground black pepper"
            },
            {
              "name" : "Can oil-packed tuna",
              "quantity" : "140g"
            }
          ],
          "created" : "2011/02/21",
          "ratings" : [
            0.5,
            1.0,
            0.5,
            1.5,
            2.0
          ]
        }
      }
    ]
  }
}
```
A small thing to notice is that the scores are exactly one lower, which is the result of the constant score no longer being applied as when the query was within the mastery.

The query matches recipes containing Parmesan with a preparation time of maximum 15 minutes.

I want to refine the query a bit because I noticed that one of the recipes contain tuna and I don't like it.

I therefore want to filter out recipes containing tuna as an ingredient, so kind of the opposite of the most objects.

This can easily be done with a must underscore, not objects.

The syntax is the same as the other objects.

So nothing new here.

So let's go ahead and add that.

## Adding a query clause to the `must_not` key

```
GET /recipe/_search
{
  "query": {
    "bool": {
      "must": [
        {
          "match": {
            "ingredients.name": "parmesan"
          }
        }
      ],
      "must_not": [
        {
          "match": {
            "ingredients.name": "tuna"
          }
        }
      ],
      "filter": [
        {
          "range": {
            "preparation_time_minutes": {
              "lte": 15
            }
          }
        }
      ]
    }
  }
}
```

So must underscore nuts.

Again, I'll specify it as an array, but if you prefer an object, you can go ahead and do that.

And actually I'll just be lazy and make a copy of this query here and paste it in and just change the value to tuna and let's run it.
```
{
  "took" : 1,
  "timed_out" : false,
  "_shards" : {
    "total" : 1,
    "successful" : 1,
    "skipped" : 0,
    "failed" : 0
  },
  "hits" : {
    "total" : {
      "value" : 2,
      "relation" : "eq"
    },
    "max_score" : 1.379573,
    "hits" : [
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "1",
        "_score" : 1.379573,
        "_ignored" : [
          "description.keyword",
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Fast and Easy Pasta With Blistered Cherry Tomato Sauce",
          "description" : "Cherry tomatoes are almost always sweeter, riper, and higher in pectin than larger tomatoes at the supermarket. All of these factors mean that cherry tomatoes are fantastic for making a rich, thick, flavorful sauce. Even better: It takes only four ingredients and about 10 minutes, start to finish—less time than it takes to cook the pasta you're gonna serve it with.",
          "preparation_time_minutes" : 12,
          "servings" : {
            "min" : 4,
            "max" : 6
          },
          "steps" : [
            "Place pasta in a large skillet or sauté pan and cover with water and a big pinch of salt. Bring to a boil over high heat, stirring occasionally. Boil until just shy of al dente, about 1 minute less than the package instructions recommend.",
            "Meanwhile, heat garlic and 4 tablespoons (60ml) olive oil in a 12-inch skillet over medium heat, stirring frequently, until garlic is softened but not browned, about 3 minutes. Add tomatoes and cook, stirring, until tomatoes begin to burst. You can help them along by pressing on them with the back of a wooden spoon as they soften.",
            "Continue to cook until sauce is rich and creamy, about 5 minutes longer. Stir in basil and season to taste with salt and pepper.",
            "When pasta is cooked, drain, reserving 1 cup of pasta water. Add pasta to sauce and increase heat to medium-high. Cook, stirring and tossing constantly and adding reserved pasta water as necessary to adjust consistency to a nice, creamy flow. Remove from heat, stir in remaining 2 tablespoons (30ml) olive oil, and grate in a generous shower of Parmesan cheese. Serve immediately, passing extra Parmesan at the table."
          ],
          "ingredients" : [
            {
              "name" : "Dry pasta",
              "quantity" : "450g"
            },
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Cloves garlic",
              "quantity" : "4"
            },
            {
              "name" : "Extra-virgin olive oil",
              "quantity" : "90ml"
            },
            {
              "name" : "Cherry tomatoes",
              "quantity" : "750g"
            },
            {
              "name" : "Fresh basil leaves",
              "quantity" : "30g"
            },
            {
              "name" : "Freshly ground black pepper"
            },
            {
              "name" : "Parmesan cheese"
            }
          ],
          "created" : "2017/03/29",
          "ratings" : [
            4.5,
            5.0,
            3.0,
            4.5
          ]
        }
      },
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "10",
        "_score" : 1.2786832,
        "_ignored" : [
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Penne With Hot-As-You-Dare Arrabbiata Sauce",
          "description" : """Exceedingly simple in concept and execution, arrabbiata sauce is tomato sauce with the distinction of being spicy enough to earn its "angry" moniker. Here's how to make it, from start to finish.""",
          "preparation_time_minutes" : 15,
          "servings" : {
            "min" : 4,
            "max" : 4
          },
          "steps" : [
            "In a medium saucepan of boiling salted water, cook penne until just short of al dente, about 1 minute less than the package recommends.",
            "Meanwhile, in a large skillet, combine oil, garlic, and pepper flakes. Cook over medium heat until garlic is very lightly golden, about 5 minutes. (Adjust heat as necessary to keep it gently sizzling.)",
            "Add tomatoes, stir to combine, and bring to a bare simmer. When pasta is ready, transfer it to sauce using a strainer or slotted spoon. (Alternatively, drain pasta through a colander, reserving 1 cup of cooking water. Add drained pasta to sauce.)",
            "Add about 1/4 cup pasta water to sauce and increase heat to bring pasta and sauce to a vigorous simmer. Cook, stirring and shaking the pan and adding more pasta water as necessary to keep sauce loose, until pasta is perfectly al dente, 1 to 2 minutes longer. (The pasta will cook more slowly in the sauce than it did in the water.)",
            "Continue cooking pasta until sauce thickens and begins to coat noodles, then remove from heat and toss in cheese and parsley, stirring vigorously to incorporate. Stir in a drizzle of fresh olive oil, if desired. Season with salt and serve right away, passing more cheese at the table."
          ],
          "ingredients" : [
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Penne pasta",
              "quantity" : "450g"
            },
            {
              "name" : "Extra-virgin olive oil",
              "quantity" : "3 tablespoons"
            },
            {
              "name" : "Clove garlic",
              "quantity" : "1"
            },
            {
              "name" : "Crushed red pepper"
            },
            {
              "name" : "Can whole peeled tomatoes",
              "quantity" : "400g"
            },
            {
              "name" : "Finely grated Parmesan cheese",
              "quantity" : "60g"
            },
            {
              "name" : "Minced flat-leaf parsley leaves",
              "quantity" : "Small handful"
            }
          ],
          "created" : "2017/04/27",
          "ratings" : [
            1.5,
            2.0,
            4.0,
            3.5,
            3.0,
            5.0,
            1.5
          ]
        }
      }
    ]
  }
}
```
So documents must not match the query that I just added.

The query closes within the must underscore not objects are executed in the filter context.

Exactly as with the filter objects, scoring is therefore ignored and the score of zero is returned for all documents.

As with any other queries in the filter context, queries within the must not object are also considered for caching.

The reason I say considered is that that is something Elasticsearch handles first, so there is no guarantee that a query will be cached, although chances are that it will.

Okay, so I want to add something else to the query now.

While I don't like tuna, I really like parsley.

So I want to rank recipes that contain parsley higher.

I can do that by adding a query similar to the other ones.

So assert objects.

So let's go ahead and add a new key named Stuart following the same syntax as the other keys.

## Adding a query clause to the `should` key

```
GET /recipe/_search
{
  "query": {
    "bool": {
      "must": [
        {
          "match": {
            "ingredients.name": "parmesan"
          }
        }
      ],
      "must_not": [
        {
          "match": {
            "ingredients.name": "tuna"
          }
        }
      ],
      "should": [
        {
          "match": {
            "ingredients.name": "parsley"
          }
        }
      ],
      "filter": [
        {
          "range": {
            "preparation_time_minutes": {
              "lte": 15
            }
          }
        }
      ]
    }
  }
}
```
And again, I'll just make a copy of this query, paste it in and insert parsley as the value here.

And before talking further about it, I'll just go ahead and run it.
```
{
  "took" : 19,
  "timed_out" : false,
  "_shards" : {
    "total" : 1,
    "successful" : 1,
    "skipped" : 0,
    "failed" : 0
  },
  "hits" : {
    "total" : {
      "value" : 2,
      "relation" : "eq"
    },
    "max_score" : 2.1593752,
    "hits" : [
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "10",
        "_score" : 2.1593752,
        "_ignored" : [
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Penne With Hot-As-You-Dare Arrabbiata Sauce",
          "description" : """Exceedingly simple in concept and execution, arrabbiata sauce is tomato sauce with the distinction of being spicy enough to earn its "angry" moniker. Here's how to make it, from start to finish.""",
          "preparation_time_minutes" : 15,
          "servings" : {
            "min" : 4,
            "max" : 4
          },
          "steps" : [
            "In a medium saucepan of boiling salted water, cook penne until just short of al dente, about 1 minute less than the package recommends.",
            "Meanwhile, in a large skillet, combine oil, garlic, and pepper flakes. Cook over medium heat until garlic is very lightly golden, about 5 minutes. (Adjust heat as necessary to keep it gently sizzling.)",
            "Add tomatoes, stir to combine, and bring to a bare simmer. When pasta is ready, transfer it to sauce using a strainer or slotted spoon. (Alternatively, drain pasta through a colander, reserving 1 cup of cooking water. Add drained pasta to sauce.)",
            "Add about 1/4 cup pasta water to sauce and increase heat to bring pasta and sauce to a vigorous simmer. Cook, stirring and shaking the pan and adding more pasta water as necessary to keep sauce loose, until pasta is perfectly al dente, 1 to 2 minutes longer. (The pasta will cook more slowly in the sauce than it did in the water.)",
            "Continue cooking pasta until sauce thickens and begins to coat noodles, then remove from heat and toss in cheese and parsley, stirring vigorously to incorporate. Stir in a drizzle of fresh olive oil, if desired. Season with salt and serve right away, passing more cheese at the table."
          ],
          "ingredients" : [
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Penne pasta",
              "quantity" : "450g"
            },
            {
              "name" : "Extra-virgin olive oil",
              "quantity" : "3 tablespoons"
            },
            {
              "name" : "Clove garlic",
              "quantity" : "1"
            },
            {
              "name" : "Crushed red pepper"
            },
            {
              "name" : "Can whole peeled tomatoes",
              "quantity" : "400g"
            },
            {
              "name" : "Finely grated Parmesan cheese",
              "quantity" : "60g"
            },
            {
              "name" : "Minced flat-leaf parsley leaves",
              "quantity" : "Small handful"
            }
          ],
          "created" : "2017/04/27",
          "ratings" : [
            1.5,
            2.0,
            4.0,
            3.5,
            3.0,
            5.0,
            1.5
          ]
        }
      },
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "1",
        "_score" : 1.379573,
        "_ignored" : [
          "description.keyword",
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Fast and Easy Pasta With Blistered Cherry Tomato Sauce",
          "description" : "Cherry tomatoes are almost always sweeter, riper, and higher in pectin than larger tomatoes at the supermarket. All of these factors mean that cherry tomatoes are fantastic for making a rich, thick, flavorful sauce. Even better: It takes only four ingredients and about 10 minutes, start to finish—less time than it takes to cook the pasta you're gonna serve it with.",
          "preparation_time_minutes" : 12,
          "servings" : {
            "min" : 4,
            "max" : 6
          },
          "steps" : [
            "Place pasta in a large skillet or sauté pan and cover with water and a big pinch of salt. Bring to a boil over high heat, stirring occasionally. Boil until just shy of al dente, about 1 minute less than the package instructions recommend.",
            "Meanwhile, heat garlic and 4 tablespoons (60ml) olive oil in a 12-inch skillet over medium heat, stirring frequently, until garlic is softened but not browned, about 3 minutes. Add tomatoes and cook, stirring, until tomatoes begin to burst. You can help them along by pressing on them with the back of a wooden spoon as they soften.",
            "Continue to cook until sauce is rich and creamy, about 5 minutes longer. Stir in basil and season to taste with salt and pepper.",
            "When pasta is cooked, drain, reserving 1 cup of pasta water. Add pasta to sauce and increase heat to medium-high. Cook, stirring and tossing constantly and adding reserved pasta water as necessary to adjust consistency to a nice, creamy flow. Remove from heat, stir in remaining 2 tablespoons (30ml) olive oil, and grate in a generous shower of Parmesan cheese. Serve immediately, passing extra Parmesan at the table."
          ],
          "ingredients" : [
            {
              "name" : "Dry pasta",
              "quantity" : "450g"
            },
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Cloves garlic",
              "quantity" : "4"
            },
            {
              "name" : "Extra-virgin olive oil",
              "quantity" : "90ml"
            },
            {
              "name" : "Cherry tomatoes",
              "quantity" : "750g"
            },
            {
              "name" : "Fresh basil leaves",
              "quantity" : "30g"
            },
            {
              "name" : "Freshly ground black pepper"
            },
            {
              "name" : "Parmesan cheese"
            }
          ],
          "created" : "2017/03/29",
          "ratings" : [
            4.5,
            5.0,
            3.0,
            4.5
          ]
        }
      }
    ]
  }
}
```
Now the Stewart object is a bit special.

It basically means the queries within it boost a score if they match, but they are not required to match.

So a recipe that contains parsley is likely to score higher than one without parsley.

This is no guarantee, as it depends on how well other queries match to.

But you can think of it as an object in which you can define preferences.

Like I prefer recipes with parsley, but I don't require them to contain parsley.

Looking at the results, we should see that the first recipe contains parsley as an ingredient, and indeed it does.

Like I said, there is no guarantee the recipes with parsley will be scored highest, but they will get a boosted score.

The reason I said that this should object is a bit special is that its behavior depends on a pool query as a whole and what else it contains.

If the pool query is in a query context and contains a must or filter object, then the search queries do not need to match for a document to match the pool query as a whole.

If this is the case, the only purpose of the search queries is to influence the relevance scores of matching documents.

On the other hand, if the pool query is in a filtering context, or if it doesn't have a must or filter object, then at least one of the search queries must match.

That's because the search queries are intended for boosting documents, matching a set of queries, but the documents should still satisfy some concerns.

Otherwise every single document in an index would be matched.

You can actually control this behavior with the minimum underscore should underscore match parameter, which allows you to define how many short clauses must match.

The simplest usage is by specifying a number, but you can also define percentages.

But that gets a little complicated and it's really necessary.

Did all of that sound confusing?

Don't worry, I totally understand that.

Here are a few example queries to make what I just said easier to understand.

What I want to do first is to match documents that contain pasta as an ingredient and optionally parmesan.

So a must query and a search query respectively.

## The behavior of `should` query clauses depends

```
GET /recipe/_search
{
  "query": {
    "bool": {
      "must": [
        {
          "match": {
            "ingredients.name": "pasta"
          }
        }
      ],
      "should": [
        {
          "match": {
            "ingredients.name": "parmesan"
          }
        }
      ]
    }
  }
}
```
So I'll just make a copy of this query.

And modified accordingly.

So let's just get rid of the filter.

And also the must not key.

And then I'll be querying for the term pasta within ingredients and also parmesan.

Okay.

And let's run it.
```
{
  "took" : 8,
  "timed_out" : false,
  "_shards" : {
    "total" : 1,
    "successful" : 1,
    "skipped" : 0,
    "failed" : 0
  },
  "hits" : {
    "total" : {
      "value" : 6,
      "relation" : "eq"
    },
    "max_score" : 2.759146,
    "hits" : [
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "1",
        "_score" : 2.759146,
        "_ignored" : [
          "description.keyword",
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Fast and Easy Pasta With Blistered Cherry Tomato Sauce",
          "description" : "Cherry tomatoes are almost always sweeter, riper, and higher in pectin than larger tomatoes at the supermarket. All of these factors mean that cherry tomatoes are fantastic for making a rich, thick, flavorful sauce. Even better: It takes only four ingredients and about 10 minutes, start to finish—less time than it takes to cook the pasta you're gonna serve it with.",
          "preparation_time_minutes" : 12,
          "servings" : {
            "min" : 4,
            "max" : 6
          },
          "steps" : [
            "Place pasta in a large skillet or sauté pan and cover with water and a big pinch of salt. Bring to a boil over high heat, stirring occasionally. Boil until just shy of al dente, about 1 minute less than the package instructions recommend.",
            "Meanwhile, heat garlic and 4 tablespoons (60ml) olive oil in a 12-inch skillet over medium heat, stirring frequently, until garlic is softened but not browned, about 3 minutes. Add tomatoes and cook, stirring, until tomatoes begin to burst. You can help them along by pressing on them with the back of a wooden spoon as they soften.",
            "Continue to cook until sauce is rich and creamy, about 5 minutes longer. Stir in basil and season to taste with salt and pepper.",
            "When pasta is cooked, drain, reserving 1 cup of pasta water. Add pasta to sauce and increase heat to medium-high. Cook, stirring and tossing constantly and adding reserved pasta water as necessary to adjust consistency to a nice, creamy flow. Remove from heat, stir in remaining 2 tablespoons (30ml) olive oil, and grate in a generous shower of Parmesan cheese. Serve immediately, passing extra Parmesan at the table."
          ],
          "ingredients" : [
            {
              "name" : "Dry pasta",
              "quantity" : "450g"
            },
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Cloves garlic",
              "quantity" : "4"
            },
            {
              "name" : "Extra-virgin olive oil",
              "quantity" : "90ml"
            },
            {
              "name" : "Cherry tomatoes",
              "quantity" : "750g"
            },
            {
              "name" : "Fresh basil leaves",
              "quantity" : "30g"
            },
            {
              "name" : "Freshly ground black pepper"
            },
            {
              "name" : "Parmesan cheese"
            }
          ],
          "created" : "2017/03/29",
          "ratings" : [
            4.5,
            5.0,
            3.0,
            4.5
          ]
        }
      },
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "10",
        "_score" : 2.5573664,
        "_ignored" : [
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Penne With Hot-As-You-Dare Arrabbiata Sauce",
          "description" : """Exceedingly simple in concept and execution, arrabbiata sauce is tomato sauce with the distinction of being spicy enough to earn its "angry" moniker. Here's how to make it, from start to finish.""",
          "preparation_time_minutes" : 15,
          "servings" : {
            "min" : 4,
            "max" : 4
          },
          "steps" : [
            "In a medium saucepan of boiling salted water, cook penne until just short of al dente, about 1 minute less than the package recommends.",
            "Meanwhile, in a large skillet, combine oil, garlic, and pepper flakes. Cook over medium heat until garlic is very lightly golden, about 5 minutes. (Adjust heat as necessary to keep it gently sizzling.)",
            "Add tomatoes, stir to combine, and bring to a bare simmer. When pasta is ready, transfer it to sauce using a strainer or slotted spoon. (Alternatively, drain pasta through a colander, reserving 1 cup of cooking water. Add drained pasta to sauce.)",
            "Add about 1/4 cup pasta water to sauce and increase heat to bring pasta and sauce to a vigorous simmer. Cook, stirring and shaking the pan and adding more pasta water as necessary to keep sauce loose, until pasta is perfectly al dente, 1 to 2 minutes longer. (The pasta will cook more slowly in the sauce than it did in the water.)",
            "Continue cooking pasta until sauce thickens and begins to coat noodles, then remove from heat and toss in cheese and parsley, stirring vigorously to incorporate. Stir in a drizzle of fresh olive oil, if desired. Season with salt and serve right away, passing more cheese at the table."
          ],
          "ingredients" : [
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Penne pasta",
              "quantity" : "450g"
            },
            {
              "name" : "Extra-virgin olive oil",
              "quantity" : "3 tablespoons"
            },
            {
              "name" : "Clove garlic",
              "quantity" : "1"
            },
            {
              "name" : "Crushed red pepper"
            },
            {
              "name" : "Can whole peeled tomatoes",
              "quantity" : "400g"
            },
            {
              "name" : "Finely grated Parmesan cheese",
              "quantity" : "60g"
            },
            {
              "name" : "Minced flat-leaf parsley leaves",
              "quantity" : "Small handful"
            }
          ],
          "created" : "2017/04/27",
          "ratings" : [
            1.5,
            2.0,
            4.0,
            3.5,
            3.0,
            5.0,
            1.5
          ]
        }
      },
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "21",
        "_score" : 1.9347944,
        "_ignored" : [
          "description.keyword",
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Crispy Baked Pasta With Mushrooms, Sausage, and Parmesan Cream Sauce",
          "description" : "This recipe starts off with crumbled Italian sausage cooked down in a bit of butter. I sauté a few types of mushrooms in the rendered fat, then flavor them with shallots, garlic, and a little bit of soy sauce and lemon juice (this helps bring out their savoriness while also lightening them up). They get finished in a simple creamy sauce flavored with Parmesan cheese. Add some pasta, top it all of with crisp bread crumbs, bake it directly in the cast iron pan you cooked it in, and you've got yourself a one-skillet meal fit for normal everyday folks who perhaps might occasionally feel like kings.",
          "preparation_time_minutes" : 30,
          "servings" : {
            "min" : 4,
            "max" : 6
          },
          "steps" : [
            "Bring a large pot of salted water to a boil and keep at a bare simmer. Combine bread crumbs, 2 ounces cheese, half of parsley, half of chives, 1/4 of shallots, 1/4 of garlic, and olive oil in a medium bowl and massage with hands until combined. Season to taste with salt and pepper.",
            "Melt butter in a large cast iron skillet over medium-high heat until foaming. Add sausage and cook, mashing it with a potato masher or a wooden spoon until broken up and well browned, about 7 minutes. Use a slotted spoon to transfer sausage to a small bowl, leaving fat behind.",
            "Increase heat to high, add mushrooms to skillet, and cook, stirring frequently, until moisture has evaporated and mushrooms are well-browned, about 10 minutes. Add shallots and garlic and cook, stirring, until fragrant, about 30 seconds. Add soy sauce and lemon juice and stir to combine.",
            "Add flour and cook, stirring, until a thin film begins to form on the bottom of the pan, about 1 minute. Slowly whisk in chicken broth followed by heavy cream. Bring to a simmer and cook until thickened, about 2 minutes. Stir in remaining grated cheese until melted. Stir in remaining parsley and chives. Stir in sausage. Season to taste with salt and lots of black pepper.",
            "Adjust rack to 10 inches below broiler element and preheat broiler to high. Cook pasta in salted water according to package directions, removing it when still just shy of al dente. Drain, reserving 1 cup of cooking liquid. Return to pot. Add mushroom mixture and stir to combine, adding liquid to adjust consistency. Pasta should be very loose but not soupy. Return to cast iron skillet and top with bread crumbs. Broil until golden brown, rotating pan as necessary, 2 to 3 minutes. Serve immediately."
          ],
          "ingredients" : [
            {
              "name" : "Panko-style bread crumbs",
              "quantity" : "1 cup"
            },
            {
              "name" : "Grated Parmesan cheese",
              "quantity" : "175g"
            },
            {
              "name" : "Chopped fresh parsley leaves",
              "quantity" : "1/4 cup"
            },
            {
              "name" : "Finely minced fresh chives",
              "quantity" : "2 tablespoons"
            },
            {
              "name" : "Shallots",
              "quantity" : "2"
            },
            {
              "name" : "Cloves garlic",
              "quantity" : "2"
            },
            {
              "name" : "Extra-virgin olive oil",
              "quantity" : "2 tablespoons"
            },
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Freshly ground black pepper"
            },
            {
              "name" : "Unsalted butter",
              "quantity" : "2 tablespoons"
            },
            {
              "name" : "Italian sausage",
              "quantity" : "225g"
            },
            {
              "name" : "Mixed mushrooms",
              "quantity" : "450g"
            },
            {
              "name" : "Soy sauce",
              "quantity" : "1 tablespoon"
            },
            {
              "name" : "Fresh lemon juice",
              "quantity" : "1 tablespoon"
            },
            {
              "name" : "Flour",
              "quantity" : "2,5 tablespoons"
            },
            {
              "name" : "Homemade chicken stock",
              "quantity" : "2 cups"
            },
            {
              "name" : "Heavy cream",
              "quantity" : "1 cup"
            },
            {
              "name" : "Fresh ridged pasta",
              "quantity" : "350g"
            }
          ],
          "created" : "2002/10/21",
          "ratings" : [
            4.0,
            3.5
          ]
        }
      },
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "13",
        "_score" : 1.4245319,
        "_ignored" : [
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Pesto Pasta With Potatoes and Green Beans",
          "description" : "This classic Genovese method of preparing pasta with pesto includes cubes of potato and pieces of green bean, all cooked together in the pasta pot until tender.",
          "preparation_time_minutes" : 15,
          "servings" : {
            "min" : 4,
            "max" : 4
          },
          "steps" : [
            "In a large pot of salted boiling water, boil pasta, potato, and green beans until pasta is al dente and potato and green beans are very tender. Drain, reserving 1 cup cooking water, and transfer pasta, potato, and green beans to a large mixing or serving bowl.",
            "Add pesto sauce to pasta along with 1/4 cup pasta cooking water. Toss well to emulsify pesto and pasta water into a creamy sauce. Add more pasta water, 1 tablespoon at a time, as needed, if pasta is too dry. Drizzle in fresh olive oil, if desired. Serve with Parmigiano Reggiano on the side."
          ],
          "ingredients" : [
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Dried pasta",
              "quantity" : "450g"
            },
            {
              "name" : "Peeled Yukon Gold potato",
              "quantity" : "140g"
            },
            {
              "name" : "Green beans",
              "quantity" : "110g"
            },
            {
              "name" : "Pesto sauce"
            },
            {
              "name" : "Extra-virgin olive oil"
            },
            {
              "name" : "Grated Parmigiano Reggiano"
            }
          ],
          "created" : "2010/12/21",
          "ratings" : [ ]
        }
      },
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "9",
        "_score" : 1.2249347,
        "_ignored" : [
          "description.keyword",
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Bucatini all'Amatriciana",
          "description" : "Debate rages over the correct way to make a classic Roman amatriciana sauce of cured pork and tomatoes. We tested all the variables to come up with this ideal version, which packs a delicate heat, gentle black-pepper spice, sharp Pecorino Romano cheese, and the intriguing interplay of sweet-tart tomato sauce and rich, fatty cured pork.",
          "preparation_time_minutes" : 20,
          "servings" : {
            "min" : 4,
            "max" : 4
          },
          "steps" : [
            "In a large skillet, heat olive oil over medium-high heat until shimmering. Add guanciale and pepper flakes and cook, stirring, until lightly browned, about 5 minutes. Add wine and cook, scraping up any browned bits on bottom of pan, until nearly evaporated, about 3 minutes.",
            "Add tomatoes and bring to a simmer. Season with salt and pepper.",
            "Meanwhile, boil pasta in salted water until just shy of al dente, about 1 minute less than package recommends. Using tongs, transfer pasta to sauce, along with 1/4 cup pasta cooking water. Cook over high heat, stirring and tossing rapidly, until pasta is al dente and sauce has thickened and begins to coat noodles. Remove from heat, add cheese, and stir rapidly to incorporate. Season to taste with more salt and pepper. Serve right away, passing more cheese at the table."
          ],
          "ingredients" : [
            {
              "name" : "Extra-virgin olive oil",
              "quantity" : "1 teaspoon"
            },
            {
              "name" : "Guanciale",
              "quantity" : "170g"
            },
            {
              "name" : "Pinch red pepper flakes"
            },
            {
              "name" : "Dry white wine",
              "quantity" : "60ml"
            },
            {
              "name" : "Can whole peeled tomatoes",
              "quantity" : "425g"
            },
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Freshly ground black pepper"
            },
            {
              "name" : "Dried bucatini pasta",
              "quantity" : "450g"
            },
            {
              "name" : "Grated Pecorino Romano cheese",
              "quantity" : "30g"
            }
          ],
          "created" : "2016/09/24",
          "ratings" : [
            5.0,
            5.0,
            4.5,
            5.0,
            4.0,
            5.0,
            3.5,
            4.5
          ]
        }
      },
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "18",
        "_score" : 1.2249347,
        "_ignored" : [
          "description.keyword",
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Vegetarian Citrus Pasta With Swiss Chard",
          "description" : "Sumac is a Middle Eastern spice that has a tart lemony flavor. You can find it in specialty shops or order it online. I used whole wheat fusilli, which required about a half cup more liquid than regular pasta and adds a denser mouthfeel to the dish. You can use regular as well—just decrease the cooking liquid by 1/2 cup.",
          "preparation_time_minutes" : 20,
          "servings" : {
            "min" : 4,
            "max" : 4
          },
          "steps" : [
            "Heat the oil in a 12-inch skillet over medium-high heat until shimmering. Add the chard stems and season with salt and cook until they begin to soften, about 3 minutes. Add the shallots and cook until they have softened, adding another pinch of salt and the red chile flakes, about 2 minutes.",
            "Add the stock to the pan with the fusilli and adjust the heat to maintain a vigorous boil and cook according to the package directions until the pasta has about 4 minutes left in the cooking process. Then, stir in the chard leaves and cook until the pasta and chard are done. Stir in the lemon juice and zest and adjust the seasoning as needed. Divide among plates, sprinkle with the sumac and freshly grated cheese."
          ],
          "ingredients" : [
            {
              "name" : "Olive oil",
              "quantity" : "2 tablespoons"
            },
            {
              "name" : "Swiss chard",
              "quantity" : "A bunch"
            },
            {
              "name" : "Large shallot",
              "quantity" : "1"
            },
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Freshly ground black pepper"
            },
            {
              "name" : "Dried red chile flakes"
            },
            {
              "name" : "Homemade vegetable stock",
              "quantity" : "4,5 cups"
            },
            {
              "name" : "Whole wheat fusilli pasta",
              "quantity" : "450g"
            },
            {
              "name" : "Fresh lemon juice",
              "quantity" : "2 tablespoons"
            },
            {
              "name" : "Sumac",
              "quantity" : "1 tablespoon"
            },
            {
              "name" : "Parmigiano-Reggiano"
            }
          ],
          "created" : "2007/10/29",
          "ratings" : [
            5.0,
            5.0,
            4.5,
            3.0,
            2.5,
            4.0,
            4.5,
            3.5,
            4.0
          ]
        }
      }
    ]
  }
}
```

So this query is similar to what we wrote before, although a bit simpler.

It matches recipes with pasta as an ingredient and gives a relevance boost to recipes with Parmesan.

Let's now try to remove the must object altogether and inspect the results.
```

```
GET /recipe/_search
{
  "query": {
    "bool": {
      "should": [
        {
          "match": {
            "ingredients.name": "parmesan"
          }
        }
      ]
    }
  }
}
```
So let's get rid of this. and run the query again.
```
{
  "took" : 2,
  "timed_out" : false,
  "_shards" : {
    "total" : 1,
    "successful" : 1,
    "skipped" : 0,
    "failed" : 0
  },
  "hits" : {
    "total" : {
      "value" : 6,
      "relation" : "eq"
    },
    "max_score" : 1.379573,
    "hits" : [
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "1",
        "_score" : 1.379573,
        "_ignored" : [
          "description.keyword",
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Fast and Easy Pasta With Blistered Cherry Tomato Sauce",
          "description" : "Cherry tomatoes are almost always sweeter, riper, and higher in pectin than larger tomatoes at the supermarket. All of these factors mean that cherry tomatoes are fantastic for making a rich, thick, flavorful sauce. Even better: It takes only four ingredients and about 10 minutes, start to finish—less time than it takes to cook the pasta you're gonna serve it with.",
          "preparation_time_minutes" : 12,
          "servings" : {
            "min" : 4,
            "max" : 6
          },
          "steps" : [
            "Place pasta in a large skillet or sauté pan and cover with water and a big pinch of salt. Bring to a boil over high heat, stirring occasionally. Boil until just shy of al dente, about 1 minute less than the package instructions recommend.",
            "Meanwhile, heat garlic and 4 tablespoons (60ml) olive oil in a 12-inch skillet over medium heat, stirring frequently, until garlic is softened but not browned, about 3 minutes. Add tomatoes and cook, stirring, until tomatoes begin to burst. You can help them along by pressing on them with the back of a wooden spoon as they soften.",
            "Continue to cook until sauce is rich and creamy, about 5 minutes longer. Stir in basil and season to taste with salt and pepper.",
            "When pasta is cooked, drain, reserving 1 cup of pasta water. Add pasta to sauce and increase heat to medium-high. Cook, stirring and tossing constantly and adding reserved pasta water as necessary to adjust consistency to a nice, creamy flow. Remove from heat, stir in remaining 2 tablespoons (30ml) olive oil, and grate in a generous shower of Parmesan cheese. Serve immediately, passing extra Parmesan at the table."
          ],
          "ingredients" : [
            {
              "name" : "Dry pasta",
              "quantity" : "450g"
            },
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Cloves garlic",
              "quantity" : "4"
            },
            {
              "name" : "Extra-virgin olive oil",
              "quantity" : "90ml"
            },
            {
              "name" : "Cherry tomatoes",
              "quantity" : "750g"
            },
            {
              "name" : "Fresh basil leaves",
              "quantity" : "30g"
            },
            {
              "name" : "Freshly ground black pepper"
            },
            {
              "name" : "Parmesan cheese"
            }
          ],
          "created" : "2017/03/29",
          "ratings" : [
            4.5,
            5.0,
            3.0,
            4.5
          ]
        }
      },
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "10",
        "_score" : 1.2786832,
        "_ignored" : [
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Penne With Hot-As-You-Dare Arrabbiata Sauce",
          "description" : """Exceedingly simple in concept and execution, arrabbiata sauce is tomato sauce with the distinction of being spicy enough to earn its "angry" moniker. Here's how to make it, from start to finish.""",
          "preparation_time_minutes" : 15,
          "servings" : {
            "min" : 4,
            "max" : 4
          },
          "steps" : [
            "In a medium saucepan of boiling salted water, cook penne until just short of al dente, about 1 minute less than the package recommends.",
            "Meanwhile, in a large skillet, combine oil, garlic, and pepper flakes. Cook over medium heat until garlic is very lightly golden, about 5 minutes. (Adjust heat as necessary to keep it gently sizzling.)",
            "Add tomatoes, stir to combine, and bring to a bare simmer. When pasta is ready, transfer it to sauce using a strainer or slotted spoon. (Alternatively, drain pasta through a colander, reserving 1 cup of cooking water. Add drained pasta to sauce.)",
            "Add about 1/4 cup pasta water to sauce and increase heat to bring pasta and sauce to a vigorous simmer. Cook, stirring and shaking the pan and adding more pasta water as necessary to keep sauce loose, until pasta is perfectly al dente, 1 to 2 minutes longer. (The pasta will cook more slowly in the sauce than it did in the water.)",
            "Continue cooking pasta until sauce thickens and begins to coat noodles, then remove from heat and toss in cheese and parsley, stirring vigorously to incorporate. Stir in a drizzle of fresh olive oil, if desired. Season with salt and serve right away, passing more cheese at the table."
          ],
          "ingredients" : [
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Penne pasta",
              "quantity" : "450g"
            },
            {
              "name" : "Extra-virgin olive oil",
              "quantity" : "3 tablespoons"
            },
            {
              "name" : "Clove garlic",
              "quantity" : "1"
            },
            {
              "name" : "Crushed red pepper"
            },
            {
              "name" : "Can whole peeled tomatoes",
              "quantity" : "400g"
            },
            {
              "name" : "Finely grated Parmesan cheese",
              "quantity" : "60g"
            },
            {
              "name" : "Minced flat-leaf parsley leaves",
              "quantity" : "Small handful"
            }
          ],
          "created" : "2017/04/27",
          "ratings" : [
            1.5,
            2.0,
            4.0,
            3.5,
            3.0,
            5.0,
            1.5
          ]
        }
      },
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "17",
        "_score" : 1.1915443,
        "_ignored" : [
          "description.keyword",
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Skillet Pasta With Mushrooms, Pancetta, and Wilted Greens",
          "description" : "This easy one-pot pasta dish is filled with browned bits of pancetta, earthy Shiitake mushrooms and wilted greens, and comes together in just 25 minutes. Finished with nutty shavings of Parmesan and freshly cracked black pepper, it's a perfect weeknight meal.",
          "preparation_time_minutes" : 30,
          "servings" : {
            "min" : 4,
            "max" : 4
          },
          "steps" : [
            "Heat oil in a large saucepan over medium-high heat until shimmering. Add pancetta and cook until fat begins to render and pancetta is lightly browned, about 2 minutes. Stir in mushrooms, tossing until coated with oil. Cook, stirring, until mushrooms have browned and pancetta has rendered most of its fat, about 5 minutes longer. Stir in shallots and serrano and cook until softened, about 1 minute. Remove from heat and scrape pancetta mixture into a bowl. Set aside.",
            "Add stock to now-empty saucepan and bring to a boil over high heat. Add pasta. Cook pasta, stirring occasionally, for 2 minutes less than package instructions, then stir in greens. Cook for 1 minute longer, then stir in pancetta mixture, along with all the rendered fat. Cook until the pasta is al dente, greens are wilted, and liquid has mostly evaporated and formed an emulsified, creamy sauce, about 1 minute (if necessary, add water a tablespoon at a time if liquid completely evaporates before pasta is tender).",
            "Remove from heat and stir in lemon juice and extra-virgin olive oil. Season to taste with salt and pepper. Spoon onto plates and top with Parmesan cheese. Serve immediately."
          ],
          "ingredients" : [
            {
              "name" : "Extra-virgin olive oil",
              "quantity" : "1/2 tablespoon"
            },
            {
              "name" : "Panchetta",
              "quantity" : "115g"
            },
            {
              "name" : "Shiitake mushrooms",
              "quantity" : "2 cups"
            },
            {
              "name" : "Shallot",
              "quantity" : "1"
            },
            {
              "name" : "Serrano chile pepper",
              "quantity" : "1/2"
            },
            {
              "name" : "Homemade chicken or vegetable stock",
              "quantity" : "5 cups"
            },
            {
              "name" : "Dried fusilli",
              "quantity" : "450g"
            },
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Freshly ground black pepper"
            },
            {
              "name" : "Fresh lemon juice",
              "quantity" : "2 tablespoons"
            },
            {
              "name" : "Greens (e.g. kale)",
              "quantity" : "A bunch"
            },
            {
              "name" : "Parmesan"
            }
          ],
          "created" : "2014/03/03",
          "ratings" : [
            5.0,
            1.5,
            3.0,
            4.5
          ]
        }
      },
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "19",
        "_score" : 1.1447377,
        "_ignored" : [
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Pasta With Mushrooms, Brussels Sprouts, and Parmesan",
          "description" : "A quick dinner of orecchiette pasta tossed in a clingy sauce made with mushrooms, shallots, thyme, and brussels sprouts leaves.",
          "preparation_time_minutes" : 25,
          "servings" : {
            "min" : 4,
            "max" : 4
          },
          "steps" : [
            "Bring a medium pot of salted water to a boil. Heat 1 tablespoon olive oil in a large skillet over high heat until smoking. Add brussels sprouts, toss to coat in oil, season with salt and pepper, cook without moving until well charred on one side. Toss and continue to cook until leaves are bright green and charred in spots, about 2 minutes total. Transfer to a bowl and set aside.",
            "Heat remaining 2 tablespoons oil in the same skillet over high heat until lightly smoking. Add mushrooms and cook, tossing occasionally, until moisture has been evaporated and the mushrooms are well browned, about 4 minutes. Add shallots, garlic, and thyme and cook, stirring, until shallots are softened and fragrant, about 1 minute. Add butter, lemon juice, and stock. Simmer until sauce is reduced and emulsified, about 1 minute. Season to taste with salt and pepper (this may not be necessary if stock is store-bought). Set aside off heat.",
            "Add orecchiette to pot and cook, stirring occasionally, until nearly al dente (about 1 minute less than the package instructions). Drain, reserving 1/2 cup cooking water. Add orecchiette, half of Parmesan, reserved pasta cooking water, and a generous amount of black pepper to mushrooms. Cook, stirring, over high heat until pasta is fully al dente and liquid has thickened into a sauce that coats the pasta, about 1 minute. If sauce looks greasy or broken, add 2 tablespoons of stock or water and stir vigorously to bring it back together. Stir in brussels sprouts leaves and serve, topping with more cheese at the table."
          ],
          "ingredients" : [
            {
              "name" : "Olive oil",
              "quantity" : "3 tablespoons"
            },
            {
              "name" : "Brussels sprouts",
              "quantity" : "115g"
            },
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Freshly ground black pepper"
            },
            {
              "name" : "Mixed mushrooms",
              "quantity" : "225g"
            },
            {
              "name" : "Shallot",
              "quantity" : "1"
            },
            {
              "name" : "Cloves garlic",
              "quantity" : "2"
            },
            {
              "name" : "Fresh thyme leaves",
              "quantity" : "1 teaspoon"
            },
            {
              "name" : "Butter",
              "quantity" : "4 tablespoons"
            },
            {
              "name" : "Freshly squeezed lemon juice",
              "quantity" : "2 teaspoons"
            },
            {
              "name" : "Homemade vegetable or chicken stock",
              "quantity" : "1/2 cup"
            },
            {
              "name" : "Dried orecchiette",
              "quantity" : "450g"
            },
            {
              "name" : "Freshly grated Parmesan cheese",
              "quantity" : "55g"
            }
          ],
          "created" : "2015/02/14",
          "ratings" : [
            3.5,
            4.0,
            3.5,
            3.0,
            4.5,
            4.0
          ]
        }
      },
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "11",
        "_score" : 1.0361936,
        "_ignored" : [
          "description.keyword",
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Spaghetti Puttanesca (Pasta or Spaghetti With Capers, Olives, and Anchovies)",
          "description" : "\"Puttanesca\" literally translates to \"in the style of prostitutes,\" supposedly because the pungent aromas of garlic, anchovies, capers, and olives tossed with pasta were how Neapolitan prostitutes would lead customers to their doors. This is one of those stories that seem, in the words of Douglas Adams, apocryphal or at least wildly inaccurate. That said, it's a fitting title—puttanesca packs an aromatic punch and then some.",
          "preparation_time_minutes" : 15,
          "servings" : {
            "min" : 2,
            "max" : 3
          },
          "steps" : [
            "Place spaghetti in a large skillet, sauté pan, or saucepan and cover with water. Add a small pinch of salt. Bring to a boil over high heat, stirring occasionally to prevent pasta from sticking.",
            "Meanwhile, in a medium skillet, combine 4 tablespoons (60ml) oil, garlic, anchovies, and red pepper flakes. Cook over medium heat until garlic is very lightly golden, about 5 minutes. (Adjust heat as necessary to keep it gently sizzling.) Add capers and olives and stir to combine.",
            "Add tomatoes, stir to combine, and bring to a bare simmer. Continue to simmer until pasta is cooked to just under al dente (about 1 minute less than the package recommends).",
            "Using tongs, transfer pasta to sauce. Alternatively, drain pasta through a colander, reserving 1 cup of the cooking water. Add drained pasta to sauce.",
            "Add a few tablespoons of pasta water to sauce and increase heat to bring pasta and sauce to a vigorous simmer. Cook, stirring and shaking the pan and adding more pasta water as necessary to keep sauce loose, until pasta is perfectly al dente, 1 to 2 minutes longer. (The pasta will cook more slowly in the sauce than it did in the water.) Stir in remaining olive oil, parsley, and cheese.",
            "Season with salt and pepper. (Be generous with the pepper and scant with the salt—the dish will be plenty salty from the other ingredients.) If using, stir in canned tuna and break it up with a fork. Serve immediately with more grated cheese at the table."
          ],
          "ingredients" : [
            {
              "name" : "Dried spaghetti",
              "quantity" : "225g"
            },
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Extra-virgin olive oil",
              "quantity" : "6 tablespoons"
            },
            {
              "name" : "Cloves garlic",
              "quantity" : "4"
            },
            {
              "name" : "Anchovy fillets",
              "quantity" : "4-6"
            },
            {
              "name" : "Large pinch red pepper flakes"
            },
            {
              "name" : "Capers",
              "quantity" : "1/4 cup"
            },
            {
              "name" : "Pitted black olives",
              "quantity" : "1/4 cup"
            },
            {
              "name" : "Whole peeled tomatoes",
              "quantity" : "225g"
            },
            {
              "name" : "Minced fresh parsley leaves",
              "quantity" : "Small handful"
            },
            {
              "name" : "Finely grated Pecorino Romano or Parmesan cheese",
              "quantity" : "30g"
            },
            {
              "name" : "Freshly ground black pepper"
            },
            {
              "name" : "Can oil-packed tuna",
              "quantity" : "140g"
            }
          ],
          "created" : "2011/02/21",
          "ratings" : [
            0.5,
            1.0,
            0.5,
            1.5,
            2.0
          ]
        }
      },
      {
        "_index" : "recipe",
        "_type" : "_doc",
        "_id" : "21",
        "_score" : 0.9673972,
        "_ignored" : [
          "description.keyword",
          "steps.keyword"
        ],
        "_source" : {
          "title" : "Crispy Baked Pasta With Mushrooms, Sausage, and Parmesan Cream Sauce",
          "description" : "This recipe starts off with crumbled Italian sausage cooked down in a bit of butter. I sauté a few types of mushrooms in the rendered fat, then flavor them with shallots, garlic, and a little bit of soy sauce and lemon juice (this helps bring out their savoriness while also lightening them up). They get finished in a simple creamy sauce flavored with Parmesan cheese. Add some pasta, top it all of with crisp bread crumbs, bake it directly in the cast iron pan you cooked it in, and you've got yourself a one-skillet meal fit for normal everyday folks who perhaps might occasionally feel like kings.",
          "preparation_time_minutes" : 30,
          "servings" : {
            "min" : 4,
            "max" : 6
          },
          "steps" : [
            "Bring a large pot of salted water to a boil and keep at a bare simmer. Combine bread crumbs, 2 ounces cheese, half of parsley, half of chives, 1/4 of shallots, 1/4 of garlic, and olive oil in a medium bowl and massage with hands until combined. Season to taste with salt and pepper.",
            "Melt butter in a large cast iron skillet over medium-high heat until foaming. Add sausage and cook, mashing it with a potato masher or a wooden spoon until broken up and well browned, about 7 minutes. Use a slotted spoon to transfer sausage to a small bowl, leaving fat behind.",
            "Increase heat to high, add mushrooms to skillet, and cook, stirring frequently, until moisture has evaporated and mushrooms are well-browned, about 10 minutes. Add shallots and garlic and cook, stirring, until fragrant, about 30 seconds. Add soy sauce and lemon juice and stir to combine.",
            "Add flour and cook, stirring, until a thin film begins to form on the bottom of the pan, about 1 minute. Slowly whisk in chicken broth followed by heavy cream. Bring to a simmer and cook until thickened, about 2 minutes. Stir in remaining grated cheese until melted. Stir in remaining parsley and chives. Stir in sausage. Season to taste with salt and lots of black pepper.",
            "Adjust rack to 10 inches below broiler element and preheat broiler to high. Cook pasta in salted water according to package directions, removing it when still just shy of al dente. Drain, reserving 1 cup of cooking liquid. Return to pot. Add mushroom mixture and stir to combine, adding liquid to adjust consistency. Pasta should be very loose but not soupy. Return to cast iron skillet and top with bread crumbs. Broil until golden brown, rotating pan as necessary, 2 to 3 minutes. Serve immediately."
          ],
          "ingredients" : [
            {
              "name" : "Panko-style bread crumbs",
              "quantity" : "1 cup"
            },
            {
              "name" : "Grated Parmesan cheese",
              "quantity" : "175g"
            },
            {
              "name" : "Chopped fresh parsley leaves",
              "quantity" : "1/4 cup"
            },
            {
              "name" : "Finely minced fresh chives",
              "quantity" : "2 tablespoons"
            },
            {
              "name" : "Shallots",
              "quantity" : "2"
            },
            {
              "name" : "Cloves garlic",
              "quantity" : "2"
            },
            {
              "name" : "Extra-virgin olive oil",
              "quantity" : "2 tablespoons"
            },
            {
              "name" : "Kosher salt"
            },
            {
              "name" : "Freshly ground black pepper"
            },
            {
              "name" : "Unsalted butter",
              "quantity" : "2 tablespoons"
            },
            {
              "name" : "Italian sausage",
              "quantity" : "225g"
            },
            {
              "name" : "Mixed mushrooms",
              "quantity" : "450g"
            },
            {
              "name" : "Soy sauce",
              "quantity" : "1 tablespoon"
            },
            {
              "name" : "Fresh lemon juice",
              "quantity" : "1 tablespoon"
            },
            {
              "name" : "Flour",
              "quantity" : "2,5 tablespoons"
            },
            {
              "name" : "Homemade chicken stock",
              "quantity" : "2 cups"
            },
            {
              "name" : "Heavy cream",
              "quantity" : "1 cup"
            },
            {
              "name" : "Fresh ridged pasta",
              "quantity" : "350g"
            }
          ],
          "created" : "2002/10/21",
          "ratings" : [
            4.0,
            3.5
          ]
        }
      }
    ]
  }
}
```
We get the same number of matches, but there is an important difference.

Since we no longer have a must or filter object, at least one should query must match.

In this case we only have one query clause.

So this means that the recipes must contain parmesan.

So as you can see, removing the must object means that the parmesan ingredient went from being optional and boosting the relevant score to being required.

Suppose that we now add the query clause that are just deleted within the filter objects.

This would mean that the pasta ingredient would be required once again and that the parmesan ingredient would be optional once again.

Recipes containing Parmesan would then get a boost for their relevant scores.

I hope that makes it easier to understand because it can be a little confusing at first.

Anyways, that was how to use the pool query to add boolean logic to queries, something that you have probably seen or done before with relational databases or something like that.

