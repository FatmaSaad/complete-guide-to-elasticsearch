1
00:00:02,610 --> 00:00:07,950
このセクションでは､ クエリ結果を様々な方法で制御する方法について説明します｡ 

2
00:00:08,070 --> 00:00:13,530
まずは､ JSONの代わりになぜHTMLなのか､ JSONの場合はどのように結果をきれいに見せるのか､

3
00:00:13,530 --> 00:00:16,110
簡単なところから説明します｡

4
00:00:16,800 --> 00:00:21,420
この講義は､ あなたにとって興味深いものでなければ､ 自由に読み飛ばしてください｡ しかし､ あなたが興味を持っている場合に備えて､

5
00:00:21,420 --> 00:00:23,550
とにかくその方法を紹介したいと思います｡

6
00:00:24,000 --> 00:00:26,700
まず､ Elasticsearchを復帰させる方法について説明します｡ 

7
00:00:26,700 --> 00:00:28,440
なぜJSONではなくHTMLなのか？

8
00:00:28,740 --> 00:00:36,900
すでに簡単なクエリは用意してあるので､ あとはformatというクエリパラメータにwhy a htmlという値を追加するだけです｡

9
00:00:37,320 --> 00:00:38,400
では､ そうしましょう｡ 

10
00:00:38,430 --> 00:00:44,370
Formats equals y a m l とクエリを実行してみましょう｡ 

11
00:00:45,310 --> 00:00:48,970
そして､ ご覧の通り､ 次はメールで返ってきます｡ 

12
00:00:48,970 --> 00:00:54,520
Elasticsearchが返すJSONを人間が読みやすいように整形する方法を見ていきましょう｡ 

13
00:00:54,820 --> 00:00:56,320
でも､ どういうことなんだろう？

14
00:00:56,350 --> 00:01:00,070
と思うかもしれませんが､ それはすでに見栄えがよく､ 読みやすいからではないでしょうか？

15
00:01:00,580 --> 00:01:01,240
そうなんです｡ 

16
00:01:01,240 --> 00:01:06,910
しかし､ それはコンソール内でクエリーを実行しているからで､ コンソールが自動的にやってくれるからです｡ 

17
00:01:07,300 --> 00:01:12,580
何しろ､ グラフィカル・ユーザー・インターフェースですから､ こうしてくれるのはとても便利です｡ 

18
00:01:12,820 --> 00:01:19,330
しかし､ ターミナルでこのクエリを実行すると､ 結果があまり人間にとって読みやすいフォーマットになっていないことがわかる｡

19
00:01:19,960 --> 00:01:24,880
どうするかというと､ クエリをcurlでコピーして､ テキストエディタ内で修正します｡ 

20
00:01:25,030 --> 00:01:29,590
Elasticsearchではなく､ ローカルホストにホスト名を変更する必要があるため､ そうしています｡ 

21
00:01:29,590 --> 00:01:38,200
それは､ Dockerコンテナ内でElasticsearchとCabanaを動かしていて､ CabanaはElasticsearchのホスト名を使ってクラスタと通信しているからに他なりません｡

22
00:01:38,530 --> 00:01:48,760
とにかく､ クエリをcurlとしてコピーしてみましょう｡ テキストエディタを開けば､ あとはElasticsearchをlocalhostに置き換えるだけです｡

23
00:01:48,970 --> 00:01:53,410
ElasticsearchをDockerコンテナ内で動作させない場合は､ この作業は必要ありません｡ 

24
00:01:53,890 --> 00:01:58,630
そして､ ここでformatパラメータも取り除いておきます｡ 

25
00:01:59,620 --> 00:02:05,020
そして､ これをコピーしてターミナルを開き､ ペーストしてエンターキーを押します｡ 

26
00:02:05,500 --> 00:02:10,840
ご覧のように､ 結果はまったくきれいなものではなく､ 何が起こっているのか､ 簡単にはわからない｡ 

27
00:02:11,200 --> 00:02:15,910
テキストエディタに戻り､ Purdyという名前のカーブパラメータをコードリクエストに追加してみましょう｡ 

28
00:02:17,430 --> 00:02:21,150
だから､ クエスチョンマークを付けて､ 可愛くタイプする｡ 

29
00:02:21,210 --> 00:02:27,740
実際にはこのクエリパラメータに値を与える必要はないので､ もう一度このコピーを作成して戻ってみましょう｡

30
00:02:27,750 --> 00:02:35,580
ターミナルをクリアしてクエリを貼り付け､ もう一度エンターキーを押すと､ すべてが見やすくなりますね｡

31
00:02:36,000 --> 00:02:41,250
もちろん､ Cabanaのコンソール内で作業している場合は役に立ちませんが､ ターミナルでハッキングしているようなシナリオ､

32
00:02:41,250 --> 00:02:46,590
おそらくCabanaが利用できないような環境であれば､ このようなことがあるかもしれません｡

33
00:02:46,620 --> 00:02:50,910
おそらく､ コマンドラインから本番のクラスタをデバッグしているとか､ そういうことでしょう｡ 

34
00:02:51,210 --> 00:02:54,540
何はともあれ､ 反応をきれいにする方法がわかりましたね｡ 

35
00:02:54,570 --> 00:03:00,600
この方がはるかにリソースを消費するので､ デバッグのときだけにした方がいいのですが､ 言うまでもないことですね｡
